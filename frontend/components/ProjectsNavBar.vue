<template>
  <nav id="projectnav" class="w-full h-1/10 p-2 flex flex-row justify-between items-center bg-gray-900 text-white">
  <NuxtLink to="/Home"><img class="h-20 items-center" src="../assets/codeverse-logo-shortened.png"></NuxtLink>
  <div class="w-1/2 flex flex-row py-2 items-center align-center">
    <input v-model="title" placeholder="Title" type="text" class="h-1/12 w-1/8 p-3 flex justify-center items-center text-lg bg-transparent rounded"> 
    <font-awesome-icon icon="fa-solid fa-pen" class="px-3" />
  </div>
    
    <div class="h-2/3 w-1/5 flex justify-around items-center">
      <button class="bg-gray-500 hover:bg-gray-600 text-white  py-2.5 px-4 rounded  text-base" @click="run">Run</button>
      <button class="bg-gray-500 hover:bg-gry-600 text-white py-2.5 px-4 rounded  text-base" @click="save"><font-awesome-icon icon="fa-solid fa-floppy-disk" /> Save</button>
      <button class="bg-gray-500 hover:bg-gray-600 text-white  py-2.5 px-4 rounded text-base" @click="settings"><font-awesome-icon icon="fa-solid fa-gear" /> Settings</button>
      <button class="bg-gray-500 hover:bg-gray-600 text-white  py-2.5 px-4 rounded text-base">Publish</button>
      <!-- <img class="basis-5 rounded-full h-40 justify-self-center self-center m-1 " :src="userProfile.data.profile_pic"> -->
    </div>
  </nav>
</template>

<script>
import DBFunctions from "~/DBFunctions";
import LikeButton from './LikeButton.vue';
export default {
  components: { LikeButton },
  data(){
    return{
      userProfile: { data : ""}
    }
  },
  computed:{
    title:{
      get(){
        return this.$store.state.projectTitle
      },
      set(value){
        this.$store.commit("PUSH_TITLE", value)
      }
    },
  },
  async mounted(){
     
  },
  methods:{
      
    run(){
      try {
        const iframe = document.getElementById("iframe")
        iframe.srcdoc= 
        `<html lang="en">
          <head>
              <meta charset="UTF-8">
              <meta http-equiv="X-UA-Compatible" content="IE=edge">
              <meta name="viewport" content="width=device-width, initial-scale=1.0">
              <title>You Inspecting</title>
              <style>${this.css}</style>
          </head>
          <body>
              ${this.html}
              <script>${this.js}<\/script>
          </body>
        </html>`
      } catch (error) {
        alert(error)
      }
    },
    settings(){
      const settings = document.getElementById("settingdiv")
      settings.style.display = "flex"
    },
    async save(){
      try {
        if (this.$store.state.newProject === true){
          await DBFunctions.createProject(
            {
              "_id": this.$store.state.otherIDInfo.mongo_id,
              "project_title": this.$store.state.projectTitle,
              "description": this.$store.state.projectDescription,
              "html": this.$store.state.codeHTML,
              "css": this.$store.state.codeCSS,
              "js": this.$store.state.codeJS,
            }
          )
        }
        if (this.$store.state.newProject === false){
          await DBFunctions.updateProject({
            "_id": this.$store.state.otherIDInfo.mongo_id,
            "project_id": this.$store.state.project_id,
            "new_title": this.$store.state.projectTitle,
            "new_description": this.$store.state.projectDescription,
            "new_html": this.$store.state.codeHTML,
            "new_css": this.$store.state.codeCSS,
            "new_js": this.$store.state.codeJS,
          })
        }
      } catch (error) {
        window.alert(error)
      }
    }
  }
}
</script>
